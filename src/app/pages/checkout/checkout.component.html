<!-- checkout.component.html -->
<div class="p-4 container mat-app-background">
  <div class="row">
    <div class="col s12 m6 l6">
      <mat-card>
        <mat-card-header class="mb-2">
          <mat-card-title>ORDER DETAILS</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-form-field class="w-full">
            <mat-label>Full Name</mat-label>
            <input matInput [(ngModel)]="fullName" name="fullName" required />
          </mat-form-field>

          <mat-form-field class="w-full">
            <mat-label>Email Address</mat-label>
            <input matInput [(ngModel)]="email" name="email" required />
          </mat-form-field>

          <mat-form-field class="w-full">
            <mat-label>Phone Number</mat-label>
            <input
              matInput
              [(ngModel)]="phoneNumber"
              name="phoneNumber"
              required
            />
          </mat-form-field>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="col s12 m6" *ngIf="(cart$ | async)?.items as products">
      <!-- Cart Items -->
      <div *ngFor="let item of products | groupBy : 'productId'">
        <mat-card class="mb-2">
          <mat-card-header>
            <mat-card-title
              class="text-xl uppercase font-bold text-gray-700 tracking-wide"
            >
              Cart Items
            </mat-card-title>
          </mat-card-header>
          <mat-list>
            <ng-container *ngFor="let value of item.value; index as i">
              <mat-list-item
                *ngFor="let variant of item.value[i].product?.variants"
              >
                <div class="flex items-center justify-between">
                  <span class="flex-1 font-bold">{{
                    item.value[i].product?.name
                  }}</span>
                  <span class="flex-1">{{ variant.size }}</span>
                  <span class="flex-1 text-right">{{
                    variant.price | currency
                  }}</span>
                  <div class="flex-1 text-right">
                    <div class="flex items-center justify-end">
                      <button
                        mat-icon-button
                        (click)="decrementQuantity(item.value[i].product)"
                      >
                        <mat-icon>remove</mat-icon>
                      </button>
                      <button
                        mat-icon-button
                        (click)="incrementQuantity(item.value[i].product)"
                      >
                        <mat-icon>add</mat-icon>
                      </button>
                      <button mat-icon-button>
                        <mat-icon>delete</mat-icon>
                      </button>
                    </div>
                  </div>
                </div>
              </mat-list-item>
              <mat-divider></mat-divider>
            </ng-container>
          </mat-list>
          <mat-card-actions>
            <button
              mat-raised-button
              [disabled]="products.length === 0"
              color="accent"
            >
              Total: {{ calculateTotal() | currency }}
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>
  </div>

  <button mat-raised-button type="submit">Place Order</button>
</div>
