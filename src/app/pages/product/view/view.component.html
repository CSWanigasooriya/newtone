<div class="mat-app-background">
  <section class="productCard" *ngIf="product$ | async as product">
    <div class="container">
      <div class="info">
        <h3 class="name">{{ product?.brand }}</h3>
        <h1 class="slogan">{{ product.name }}</h1>
        <p class="price mb-2">{{ product.variants?.[0]?.price | currency }}</p>
        <p class="text-sm">{{ product.description }}</p>
        <p class="text-lg">{{ getMinStock(product.variants) }} IN STOCK</p>
        <div class="flex justify-center mt-8">
          <div class="col s6 p-1">
            <mat-form-field class="w-full">
              <mat-label>Select Color</mat-label>
              <mat-select [(ngModel)]="selectedColor" name="colorToggle">
                <mat-option
                  *ngFor="let variant of product.variants"
                  [value]="variant.color"
                >
                  {{ variant.color }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col s6 p-1">
            <mat-form-field class="w-full">
              <mat-label>Select Size</mat-label>
              <mat-select [(ngModel)]="selectedSize" name="sizeToggle">
                <mat-option
                  *ngFor="let variant of product.variants"
                  [value]="variant.size"
                >
                  {{ variant.size }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <div
          class="buttons"
          [ngClass]="{
            'disabled-item': selectedColor === null || selectedSize === null
          }"
        >
          <div class="button" (click)="handleAddToCart(product)">
            Add to cart
          </div>
          <div class="button colored">Buy now</div>
        </div>
      </div>
      <div class="container"></div>
      <div class="preview">
        <h1 class="brand">NEWTONE</h1>
        <div style="text-align: center">
          <div class="carousel-container">
            <img
              *ngFor="let variant of product?.variants; let i = index"
              [src]="variant?.image"
              [class.active]="i === activeIndex"
            />
          </div>
        </div>
        <div class="movControls">
          <div class="movControl left" (click)="prevSlide()"></div>
          <div class="movControl right" (click)="nextSlide()"></div>
        </div>
      </div>
    </div>
  </section>

  <section *ngIf="product$ | async as product">
    <div class="container">
      <div class="shadow-md p-4 md:p-6 lg:p-8">
        <h2 class="font-bold text-2xl md:text-3xl xl:text-4xl uppercase mb-4">
          Product Details
        </h2>

        <div class="overflow-x-auto">
          <table class="w-full md:min-w-max table-auto text-left">
            <tbody>
              <tr class="border-b">
                <th class="px-3 py-2 md:px-6 md:py-4 font-medium">
                  Description
                </th>
                <td class="px-3 py-2 md:px-6 md:py-4">
                  {{ product.description }}
                </td>
              </tr>
              <tr class="border-b">
                <th class="px-3 py-2 md:px-6 md:py-4 font-medium">
                  Colors Available
                </th>
                <td class="px-3 py-2 md:px-6 md:py-4">
                  {{ joinColorsAndSizes(product.variants, 'color') }}
                </td>
              </tr>
              <tr class="border-b">
                <th class="px-3 py-2 md:px-6 md:py-4 font-medium">Size</th>
                <td class="px-3 py-2 md:px-6 md:py-4">
                  {{ joinColorsAndSizes(product.variants, 'size') }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>
</div>
